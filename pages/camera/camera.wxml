<!--pages/camera/camera.wxml-->
<!-- Leica ÊûÅÁÆÄÈ£éÊ†ºÁõ∏Êú∫ÁïåÈù¢Ôºö95% ÂèñÊôØÂô® + Á∫ØÁôΩÂø´Èó® + Â§ßÂ∏àËΩ¨Áõò -->
<view class="camera-container">
  <!-- ÂÖ®Â±èÂèñÊôØÂô® (95%) -->
  <camera 
    class="camera-viewfinder" 
    device-position="{{devicePosition}}" 
    flash="{{flashMode}}"
    binderror="onCameraError">
    
    <!-- È°∂ÈÉ®Â∑•ÂÖ∑Ê†èÔºàÊûÅÁÆÄÔºâ -->
    <view class="top-toolbar">
      <view class="tool-icon" bindtap="goBack">
        <text class="icon">‚Üê</text>
      </view>
      <view class="tool-icon" bindtap="toggleFlash">
        <text class="icon">{{flashMode === 'off' ? '‚ö°' : '‚ö°'}}</text>
      </view>
      <view class="tool-icon" bindtap="switchCamera">
        <text class="icon">‚ü≤</text>
      </view>
    </view>

    <!-- Â§ßÂ∏àËΩ¨ÁõòÔºàÂø´Èó®‰∏äÊñπÔºåÊûÅÁªÜÂ≠ó‰ΩìÔºâ -->
    <view class="master-carousel">
      <scroll-view scroll-x class="master-scroll" scroll-into-view="master-{{currentMasterIndex}}">
        <view 
          wx:for="{{masterList}}" 
          wx:key="id" 
          id="master-{{index}}"
          class="master-item {{currentMasterIndex === index ? 'active' : ''}}"
          bindtap="selectMaster"
          data-index="{{index}}">
          <text class="master-abbr">{{item.abbr}}</text>
        </view>
      </scroll-view>
    </view>

    <!-- Á∫ØÁôΩÂúÜÁéØÂø´Èó®ÈîÆÔºàÂ∫ïÈÉ®‰∏≠ÂøÉÔºâ -->
    <view class="shutter-container">
      <view class="shutter-button" bindtap="takePhoto">
        <view class="shutter-inner"></view>
      </view>
    </view>

    <!-- Âè≥‰æßÂ∑•ÂÖ∑Ê†èÔºàÊûÅÁÆÄÔºâ -->
    <view class="right-toolbar">
      <view class="tool-icon-small" bindtap="openAdjustment">
        <text class="icon-small">‚öô</text>
      </view>
      <view class="tool-icon-small" bindtap="toggleGrid">
        <text class="icon-small">‚äû</text>
      </view>
    </view>

  </camera>

  <!-- Â∫ïÈÉ®ÂèÇÊï∞ÊèêÁ§∫Ôºà‰ªÖÊòæÁ§∫ÂΩìÂâçÂ§ßÂ∏àÂêçÁß∞Ôºâ -->
  <view class="bottom-hint">
    <text class="hint-text">{{currentMaster.name}}</text>
  </view>
</view>

<!-- Adjustment Ë∞ÉÊï¥ËèúÂçïÔºàÈöêËóèÂºèÔºâ -->
<view class="adjustment-panel {{showAdjustment ? 'show' : ''}}">
  <view class="adjustment-header">
    <text class="adjustment-title">Adjustment</text>
    <view class="close-icon" bindtap="closeAdjustment">
      <text>√ó</text>
    </view>
  </view>

  <!-- Ê†∏ÂøÉÂèÇÊï∞Ôºà5‰∏™Ôºâ -->
  <view class="adjustment-section">
    <view class="section-title">Core</view>
    <view class="param-item" wx:for="{{coreParams}}" wx:key="id">
      <text class="param-label">{{item.label}}</text>
      <slider 
        class="param-slider" 
        value="{{item.value}}" 
        min="{{item.min}}" 
        max="{{item.max}}" 
        activeColor="#FFFFFF"
        backgroundColor="rgba(255,255,255,0.2)"
        block-size="20"
        bindchange="onParamChange"
        data-id="{{item.id}}"/>
      <text class="param-value">{{item.value}}</text>
    </view>
  </view>

  <!-- È´òÁ∫ßÂèÇÊï∞Ôºà‰∫åÁ∫ßÊåâÈíÆÔºâ -->
  <view class="adjustment-section">
    <view class="section-title-button" bindtap="toggleAdvanced">
      <text>Advanced</text>
      <text class="arrow {{showAdvanced ? 'up' : 'down'}}">‚Ä∫</text>
    </view>
    
    <view class="advanced-params {{showAdvanced ? 'show' : ''}}">
      <view class="param-item" wx:for="{{advancedParams}}" wx:key="id">
        <text class="param-label">{{item.label}}</text>
        <slider 
          class="param-slider" 
          value="{{item.value}}" 
          min="{{item.min}}" 
          max="{{item.max}}" 
          activeColor="#FFFFFF"
          backgroundColor="rgba(255,255,255,0.2)"
          block-size="20"
          bindchange="onParamChange"
          data-id="{{item.id}}"
          disabled="{{!item.unlocked}}"/>
        <text class="param-value">{{item.value}}</text>
        <view wx:if="{{!item.unlocked}}" class="lock-badge">
          <text>üîí {{item.requiredRole}}</text>
        </view>
      </view>
    </view>
  </view>
</view>
